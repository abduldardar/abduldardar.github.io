<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archives | On regarde de plus pr√®s : l'IA G√©n√©rative</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">
                    <img src="logo.svg" alt="ZenYoTech - IA G√©n√©rative">
                </div>
                <ul class="nav-menu">
                    <li class="nav-item"><a href="index.html" class="nav-link">Accueil</a></li>
                    <li class="nav-item"><a href="archives.html" class="nav-link active">Archives</a></li>
                    <li class="nav-item"><a href="about.html" class="nav-link">√Ä propos</a></li>
                    <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
                </ul>
                <div class="datetime-display">
                    <span id="current-datetime"></span>
                </div>
                <div class="theme-toggle">
                    <button id="theme-switcher">üåô</button>
                </div>
            </div>
        </nav>
    </header>

    <main class="container">
        <section class="page-header">
            <h1>Archives des articles</h1>
            <p>D√©couvrez une s√©lection al√©atoire d'articles sur l'IA g√©n√©rative</p>
            <button id="shuffle-articles" class="shuffle-btn">M√©langer les articles</button>
        </section>

        <section class="featured-articles">
            <div id="random-articles-container" class="articles-grid">
                <!-- Les articles al√©atoires seront charg√©s ici -->
            </div>
        </section>

        <section class="all-archives">
            <h2>Tous les articles archiv√©s</h2>
            <div id="all-archives-container" class="archives-list">
                <!-- Tous les articles seront list√©s ici -->
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 ZenYoTech - Tous droits r√©serv√©s</p>
            <p>Site d√©di√© √† l'actualit√© de l'IA g√©n√©rative</p>
        </div>
    </footer>

    <script>
        // Gestion du th√®me clair/sombre
        const themeSwitcher = document.getElementById('theme-switcher');
        const currentTheme = localStorage.getItem('theme') || 'light';

        document.documentElement.setAttribute('data-theme', currentTheme);
        updateThemeButton(currentTheme);

        themeSwitcher.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeButton(newTheme);
        });

        function updateThemeButton(theme) {
            themeSwitcher.textContent = theme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        // Affichage de la date et heure
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            const dateTimeString = now.toLocaleDateString('fr-FR', options);
            document.getElementById('current-datetime').textContent = dateTimeString;
        }

        updateDateTime();
        setInterval(updateDateTime, 60000);

        // Chargement de tous les fichiers articles
        async function loadAllArticles() {
            try {
                // Liste des fichiers articles √† charger
                const articleFiles = [
                    './data/articles.json',
                    './data/articles_2024_11.json',
                    './data/articles_2024_12.json',
                    './data/articles_2025_01.json',
                    './data/articles_2025_02.json'
                    // Ajoutez ici les nouveaux fichiers au fur et √† mesure
                ];

                let allArticles = [];

                // Charger tous les fichiers
                for (const file of articleFiles) {
                    try {
                        const response = await fetch(file);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.articles && Array.isArray(data.articles)) {
                                allArticles = allArticles.concat(data.articles);
                                console.log(`Fichier ${file} charg√©: ${data.articles.length} articles`);
                            }
                        }
                    } catch (error) {
                        console.warn(`Impossible de charger le fichier ${file}:`, error);
                    }
                }

                if (allArticles.length === 0) {
                    throw new Error('Aucun article trouv√© dans les fichiers');
                }

                console.log(`Total des articles charg√©s: ${allArticles.length}`);
                return allArticles;

            } catch (error) {
                console.error('Erreur lors du chargement des articles:', error);
                throw error;
            }
        }

        // S√©lectionner 10 articles al√©atoires
        function getRandomArticles(articles, count = 10) {
            if (articles.length <= count) {
                return [...articles].sort((a, b) => new Date(b.date) - new Date(a.date));
            }
            
            // M√©langer le tableau et prendre les premiers 'count' √©l√©ments
            const shuffled = [...articles].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count).sort((a, b) => new Date(b.date) - new Date(a.date));
        }

        // Afficher les articles al√©atoires
        function displayRandomArticles(articles) {
            const container = document.getElementById('random-articles-container');
            const randomArticles = getRandomArticles(articles, 10);
            
            if (randomArticles.length === 0) {
                container.innerHTML = '<p>Aucun article disponible pour le moment.</p>';
                return;
            }

            let html = '';
            
            randomArticles.forEach(article => {
                const imageUrl = article.url_image || './images/default-tech.jpg';
                
                html += `
                    <article class="article-card">
                        <div class="article-image-container">
                            <img src="${imageUrl}" alt="${article.titre}" class="article-image" onerror="this.src='./images/default-tech.jpg'">
                        </div>
                        <div class="article-content">
                            <div class="article-meta">
                                <span class="article-date">${formatDate(article.date)}</span>
                                <span class="article-source">${getSourceName(article.lien_source)}</span>
                            </div>
                            <h3 class="article-title">${article.titre}</h3>
                            <p class="article-summary">${article.resume}</p>
                            <a href="${article.lien_source}" target="_blank" class="article-link">Lire la source</a>
                        </div>
                    </article>
                `;
            });
            
            container.innerHTML = html;
        }

        // Afficher tous les articles sous forme de liste
        function displayAllArticles(articles) {
            const container = document.getElementById('all-archives-container');
            
            // Trier par date d√©croissante
            const sortedArticles = [...articles].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            if (sortedArticles.length === 0) {
                container.innerHTML = '<p>Aucun article dans les archives pour le moment.</p>';
                return;
            }

            let html = '';
            
            sortedArticles.forEach(article => {
                const date = new Date(article.date).toLocaleDateString('fr-FR');
                
                html += `
                    <div class="archive-item">
                        <a href="${article.lien_source}" target="_blank">
                            <span class="archive-title">${article.titre}</span>
                            <span class="archive-date">${date}</span>
                        </a>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Formatage de la date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('fr-FR', options);
        }

        // Extraction du nom de la source
        function getSourceName(url) {
            try {
                const domain = new URL(url).hostname;
                return domain.replace('www.', '').split('.')[0];
            } catch (e) {
                return 'Source';
            }
        }

        // Gestion du bouton "M√©langer"
        function setupShuffleButton(allArticles) {
            const shuffleBtn = document.getElementById('shuffle-articles');
            shuffleBtn.addEventListener('click', () => {
                displayRandomArticles(allArticles);
                // Animation de feedback
                shuffleBtn.textContent = 'Articles m√©lang√©s !';
                setTimeout(() => {
                    shuffleBtn.textContent = 'M√©langer les articles';
                }, 2000);
            });
        }

        // Chargement initial
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const allArticles = await loadAllArticles();
                displayRandomArticles(allArticles);
                displayAllArticles(allArticles);
                setupShuffleButton(allArticles);
            } catch (error) {
                console.error('Erreur:', error);
                document.getElementById('random-articles-container').innerHTML = 
                    '<p>Impossible de charger les articles. Veuillez r√©essayer plus tard.</p>';
                document.getElementById('all-archives-container').innerHTML = 
                    '<p>Impossible de charger les archives.</p>';
            }
        });
    </script>

    <style>
        .shuffle-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            margin-top: 15px;
        }

        .shuffle-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .all-archives {
            margin-top: 60px;
            padding-top: 40px;
            border-top: 1px solid var(--border-color);
        }

        .all-archives h2 {
            margin-bottom: 30px;
            font-size: 1.8rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            display: inline-block;
        }

        @media (max-width: 767px) {
            .shuffle-btn {
                width: 100%;
            }
        }
    </style>
</body>
</html>